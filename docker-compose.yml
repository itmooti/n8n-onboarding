services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        VITE_VITALSYNC_API_KEY: ${VITE_VITALSYNC_API_KEY}
        VITE_VITALSYNC_SLUG: ${VITE_VITALSYNC_SLUG}
        VITE_SCRAPER_WEBHOOK_URL: ${VITE_SCRAPER_WEBHOOK_URL}
        VITE_PAYMENT_WEBHOOK_URL: ${VITE_PAYMENT_WEBHOOK_URL}
        VITE_PROVISIONING_WEBHOOK_URL: ${VITE_PROVISIONING_WEBHOOK_URL}
    ports:
      - "3050:80"
    restart: unless-stopped

  tunnel:
    image: cloudflare/cloudflared:latest
    command: tunnel run --token ${CLOUDFLARE_TUNNEL_TOKEN}
    restart: unless-stopped
    depends_on:
      - app
